# putior Manual Inspection & Quality Assurance Audit Guide

**Package**: putior v0.2.0.9000
**Audit Date**: 2026-02-06
**Auditor**: _______________
**Status**: PENDING MANUAL REVIEW

---

## Package Metrics Summary

| Metric | Value |
|--------|-------|
| R source files | 11 |
| R source lines | 11,021 |
| Test files | 14 |
| Test lines | 5,324 |
| Automated tests | 3,956 |
| Exported functions | 21 + 2 S3 methods |
| Man pages | 80 |
| Vignettes | 8 |
| Suggests dependencies | 12 |
| WORDLIST entries | 120 |
| CI/CD workflows | 3 (all green) |
| Open issues | 0 / 30 closed |

---

## QA-1: Package Structure & Integrity

### QA-1.1: Essential Files Present
- [ ] `DESCRIPTION` exists and is well-formed
- [ ] `NAMESPACE` exists (auto-generated by roxygen2)
- [ ] `LICENSE` and `LICENSE.md` exist
- [ ] `README.md` exists with installation instructions
- [ ] `NEWS.md` exists with version history
- [ ] `.Rbuildignore` exists
- [ ] `.gitignore` exists
- [ ] `_pkgdown.yml` exists

### QA-1.2: DESCRIPTION Validation
- [ ] Title is in Title Case, single line, no period
- [ ] Description is one paragraph, ends with period
- [ ] Version follows semantic versioning (X.Y.Z.9000 for dev)
- [ ] Authors@R field is valid with ORCID
- [ ] URL points to valid GitHub repo
- [ ] BugReports points to valid issues page
- [ ] License field matches LICENSE file
- [ ] Imports contains only `tools`
- [ ] Suggests are all real, available packages

```r
# Verify
desc::desc_get("Title")
desc::desc_get("Version")
desc::desc_get("Authors@R")
```

### QA-1.3: NAMESPACE Consistency
- [ ] All `@export` tagged functions appear in NAMESPACE
- [ ] No orphan exports (exported but function doesn't exist)
- [ ] S3 methods properly registered (`S3method()`)
- [ ] No unnecessary imports

```r
# Verify: regenerate and diff
devtools::document()
# Should produce no changes if already up-to-date
```

---

## QA-2: Documentation Quality

### QA-2.1: Function Documentation Completeness
- [ ] All 21 exported functions have `@param` for every argument
- [ ] All 21 exported functions have `@return` descriptions
- [ ] All 21 exported functions have `@examples`
- [ ] No broken `\link{}` or `\code{}` references in man pages
- [ ] No spelling errors in documentation

```r
devtools::spell_check()
devtools::run_examples()
```

### QA-2.2: Vignette Quality (8 vignettes)
Review each vignette renders correctly and content is accurate:

| # | Vignette | Renders | Content OK | Notes |
|---|----------|---------|------------|-------|
| 1 | `quick-start.Rmd` | [ ] | [ ] | |
| 2 | `annotation-guide.Rmd` | [ ] | [ ] | |
| 3 | `quick-reference.Rmd` | [ ] | [ ] | |
| 4 | `features-tour.Rmd` | [ ] | [ ] | |
| 5 | `api-reference.Rmd` | [ ] | [ ] | |
| 6 | `showcase.Rmd` | [ ] | [ ] | |
| 7 | `troubleshooting.Rmd` | [ ] | [ ] | |
| 8 | `skills.Rmd` | [ ] | [ ] | |

```r
# Build all vignettes
devtools::build_vignettes()
```

### QA-2.3: pkgdown Site
- [ ] Site is live at https://pjt222.github.io/putior/
- [ ] Home page loads with correct package description
- [ ] Reference index shows clean public API (no internal clutter)
- [ ] "Internal Functions" section exists separately
- [ ] All 8 vignettes accessible under Articles
- [ ] Navigation links work (Get Started, Articles, AI Skills, Cheatsheet)
- [ ] Mermaid diagrams render in vignettes on site
- [ ] Logo/favicon display correctly
- [ ] Cheatsheet PDF link works

### QA-2.4: README
- [ ] Installation instructions are correct
- [ ] Quick example runs without error
- [ ] Badges display correctly (R CMD check)
- [ ] Links to pkgdown site work
- [ ] No broken images

---

## QA-3: Test Suite Verification

### QA-3.1: Test Execution
- [ ] All tests pass locally: `devtools::test()`
- [ ] All tests pass under R CMD check: `devtools::check()`
- [ ] No tests rely on external network access
- [ ] No tests modify global state without cleanup
- [ ] Tests use `testthat` 3rd edition

```r
devtools::test()
# Expected: FAIL 0 | WARN 0 | SKIP 2 | PASS 3956
```

### QA-3.2: Test Coverage by Function Area

| Area | Test File | Tests | Status |
|------|-----------|-------|--------|
| Core scanning | `test-put.R` | | [ ] |
| Diagram generation | `test-put_diagram.R` | | [ ] |
| Auto-detection | `test-put_auto.R` | | [ ] |
| Annotation generation | `test-put_generate.R` | | [ ] |
| Merge strategies | `test-put_merge.R` | | [ ] |
| Language registry | `test-language-registry.R` | | [ ] |
| New language patterns | `test-new-language-patterns.R` | | [ ] |
| LLM patterns | `test-llm-patterns.R` | | [ ] |
| Annotation parsing | `test-parse.R` | | [ ] |
| Logging | `test-logging.R` | | [ ] |
| MCP server | `test-mcp.R` | | [ ] |
| ACP server | `test-acp.R` | | [ ] |
| Help system | `test-putior_help.R` | | [ ] |
| Sandbox app | `test-run_sandbox.R` | | [ ] |

### QA-3.3: Edge Case Coverage
- [ ] Empty input handling (no files, no annotations)
- [ ] Invalid annotation syntax handling
- [ ] Missing/malformed properties
- [ ] Non-existent file paths
- [ ] Mixed language projects
- [ ] Unicode in labels and file paths
- [ ] Large file handling

---

## QA-4: Code Quality

### QA-4.1: R CMD Check
- [ ] 0 errors
- [ ] 0 warnings
- [ ] 0 notes (or only expected notes)

```r
devtools::check()
```

### QA-4.2: Coding Standards
- [ ] No `sapply()` usage (should be `vapply()`)
- [ ] No `1:length()` or `1:nrow()` (should be `seq_len()` / `seq_along()`)
- [ ] All `stop()` and `warning()` calls use `call. = FALSE`
- [ ] No `library()` or `require()` in package code
- [ ] External package functions called with `::` notation
- [ ] No hardcoded magic values (constants centralized in `zzz.R`)

```bash
# Quick verification commands (run from package root)
grep -rn "sapply(" R/ --include="*.R"
grep -rn "1:nrow\|1:length\|1:ncol" R/ --include="*.R"
grep -rn "stop(" R/ --include="*.R" | grep -v "call. = FALSE" | grep -v "call.=FALSE"
grep -rn "warning(" R/ --include="*.R" | grep -v "call. = FALSE" | grep -v "call.=FALSE"
grep -rn "^library(\|^require(" R/ --include="*.R"
```

### QA-4.3: Architecture
- [ ] Single source of truth: `.VALID_THEMES` in `zzz.R`
- [ ] Single source of truth: `.VALID_NODE_TYPES` in `zzz.R`
- [ ] Single source of truth: `.LANGUAGES_WITH_DETECTION` in `language_registry.R`
- [ ] No duplicated logic across files
- [ ] Helper functions properly extracted (not inlined)
- [ ] S3 class `putior_workflow` properly implemented with print/summary

### QA-4.4: Dependency Hygiene
- [ ] Only `tools` in Imports (base R package, zero external deps)
- [ ] All Suggests are conditionally loaded with `requireNamespace()`
- [ ] Graceful degradation when optional packages missing
- [ ] No circular dependencies

---

## QA-5: Security Review

### QA-5.1: Input Validation
- [ ] File paths sanitized (no `..` traversal in ACP)
- [ ] Control characters rejected in ACP paths
- [ ] MCP port range validated (1-65535)
- [ ] User-supplied labels sanitized for Mermaid injection
- [ ] No `eval()` or `parse()` on user input

### QA-5.2: Sensitive Data
- [ ] No API keys or tokens in source code
- [ ] No hardcoded credentials
- [ ] No personal file paths in committed code
- [ ] `.Renviron` is in `.gitignore`
- [ ] `.Renviron.example` uses placeholder values

```bash
grep -rn "sk-\|ghp_\|Bearer\|token\|password\|secret" R/ --include="*.R" -i
grep -rn "C:\\\\Users\\\\" R/ --include="*.R"
```

### QA-5.3: Network Security
- [ ] ACP server warns when binding to 0.0.0.0
- [ ] No outbound network calls in core functions
- [ ] MCP/ACP servers are opt-in (not started automatically)

### QA-5.4: Resource Limits
- [ ] ACP run storage has LRU eviction (max 1000 runs)
- [ ] No unbounded memory growth patterns
- [ ] File operations use bounded reads

---

## QA-6: CI/CD Pipeline

### QA-6.1: Workflow Status
Verify all workflows pass on latest commit:

```bash
gh run list --limit 6
```

| Workflow | Status | Notes |
|----------|--------|-------|
| R-CMD-check | [ ] GREEN | |
| pkgdown-gh-pages | [ ] GREEN | |
| pages-build-deployment | [ ] GREEN | |

### QA-6.2: Workflow Configuration
- [ ] R-CMD-check runs on push and PR to main
- [ ] pkgdown-gh-pages deploys from `docs/` to `gh-pages` branch
- [ ] GitHub Pages configured to deploy from `gh-pages` branch
- [ ] Development mode disabled in `_pkgdown.yml`
- [ ] Proper permissions set in workflow YAML files

### QA-6.3: Build Reproducibility
- [ ] `renv.lock` exists and is up-to-date for core dependencies
- [ ] Package builds cleanly from source: `R CMD build .`
- [ ] Package installs cleanly: `R CMD INSTALL putior_*.tar.gz`

---

## QA-7: Functional Testing (Manual)

### QA-7.1: Core Workflow - Annotation Scanning
```r
library(putior)

# Scan package's own R files
workflow <- put("./R/")
print(workflow)
summary(workflow)

# Expected: data frame with putior's self-annotations, S3 class putior_workflow
```
- [ ] Returns data frame with expected columns
- [ ] S3 print method displays node count summary
- [ ] S3 summary method shows file/type breakdown

### QA-7.2: Diagram Generation
```r
diagram <- put_diagram(workflow)
# Expected: opens viewer or prints mermaid code

raw <- put_diagram(workflow, output = "raw")
cat(raw)
# Expected: valid mermaid flowchart syntax
```
- [ ] Diagram generates without error
- [ ] Raw output is valid Mermaid syntax
- [ ] All 9 themes work: `for (t in get_diagram_themes()) put_diagram(workflow, theme = t, output = "raw")`

### QA-7.3: Auto-Detection
```r
auto <- put_auto("./R/")
print(auto)
```
- [ ] Detects file I/O operations automatically
- [ ] Returns putior_workflow data frame

### QA-7.4: Multi-Language Support
```r
# Verify comment prefixes
get_comment_prefix("sql")   # "--"
get_comment_prefix("js")    # "//"
get_comment_prefix("m")     # "%"
get_comment_prefix("R")     # "#"

# Verify language listing
list_supported_languages()
list_supported_languages(detection_only = TRUE)
```
- [ ] All comment prefixes correct
- [ ] 30+ languages supported
- [ ] 15 languages with detection patterns

### QA-7.5: Help System
```r
putior_help()
putior_help("annotation")
putior_help("themes")
putior_help("languages")
putior_help("node_types")
putior_help("patterns")
putior_help("examples")
putior_help("skills")
putior_help("nonexistent")  # Should show "Unknown topic" gracefully
```
- [ ] All topics display correctly
- [ ] Unknown topic handled gracefully

### QA-7.6: Interactive Sandbox (requires shiny)
```r
# Only if shiny is installed
run_sandbox()
```
- [ ] App launches in browser
- [ ] Code input works
- [ ] Diagram renders from annotations
- [ ] Theme switching works
- [ ] Copy-to-clipboard button works

---

## QA-8: CRAN Readiness

### QA-8.1: CRAN Pre-flight Checks
```r
# Local
devtools::check(cran = TRUE)

# Win-builder
devtools::check_win_devel()
devtools::check_win_release()

# R-hub
rhub::rhub_check()

# URLs
urlchecker::url_check()

# Spelling
devtools::spell_check()
```

| Check | Result | Notes |
|-------|--------|-------|
| Local R CMD check | [ ] | |
| Win-builder devel | [ ] | |
| Win-builder release | [ ] | |
| R-hub | [ ] | |
| URL check | [ ] | |
| Spell check | [ ] | |

### QA-8.2: CRAN Policy Compliance
- [ ] Package title < 65 characters
- [ ] Description field is informative, no redundant "This package..."
- [ ] No references to "in R" in title/description (implied)
- [ ] Examples run in < 5 seconds each
- [ ] No `\dontrun{}` without justification
- [ ] No modification of user's global state (options, env vars)
- [ ] No writing to user's home directory
- [ ] Package size < 5MB after build

```r
# Check built package size
file.size(list.files(pattern = "putior.*\\.tar\\.gz"))
```

---

## QA-9: Git & Repository Hygiene

### QA-9.1: Branch State
```bash
git status
git log --oneline -10
```
- [ ] Working tree clean on main branch
- [ ] No stale feature branches
- [ ] Commit messages are descriptive

### QA-9.2: Repository Cleanliness
- [ ] No large binary files tracked (check with `git ls-files --others`)
- [ ] No sensitive files committed (`.Renviron`, credentials)
- [ ] `.gitignore` covers generated files
- [ ] `.Rbuildignore` covers development files

### QA-9.3: GitHub Repository
- [ ] All 30 issues closed
- [ ] Repository description is accurate
- [ ] Topics/tags are set
- [ ] License displayed correctly on GitHub

---

## QA-10: Sign-Off

### Findings Summary

| Severity | Count | Details |
|----------|-------|---------|
| Critical | | |
| Major | | |
| Minor | | |
| Informational | | |

### Disposition

- [ ] **APPROVED** - Package meets all quality standards
- [ ] **APPROVED WITH CONDITIONS** - Minor findings require follow-up
- [ ] **NOT APPROVED** - Major findings require remediation

### Notes
_Space for auditor observations, deviations, or recommendations:_

---

**Auditor Signature**: _______________
**Date**: _______________
**Next Review Date**: _______________
